{{ config(
    materialized = 'view'
) }}

WITH source AS (
    SELECT
        *
    FROM {{ source('nfl_raw', 'v_raw_pbp_flat') }}
)

SELECT PLAY_ID
    , GAME_ID
    , OLD_GAME_ID
    , HOME_TEAM
    , AWAY_TEAM
    , SEASON_TYPE
    , NFL_WEEK
    , POSTEAM
    , POSTEAM_TYPE
    , DEFTEAM
    , SIDE_OF_FIELD
    , YARDLINE_100
    , GAME_DATE
    , QUARTER_SECONDS_REMAINING
    , HALF_SECONDS_REMAINING
    , GAME_SECONDS_REMAINING
    , GAME_HALF
    , QUARTER_END
    , DRIVE
    , SP
    , QTR
    , DOWN
    , GOAL_TO_GO
    , GENERIC_TIME
    , YRDLN
    , YDSTOGO
    , YDSNET
    , PLAY_DESC
    , PLAY_TYPE
    , YARDS_GAINED
    , SHOTGUN
    , NO_HUDDLE
    , QB_DROPBACK
    , QB_KNEEL
    , QB_SPIKE
    , QB_SCRAMBLE
    , PASS_LENGTH
    , PASS_LOCATION
    , AIR_YARDS
    , YARDS_AFTER_CATCH
    , RUN_LOCATION
    , RUN_GAP
    , FIELD_GOAL_RESULT
    , KICK_DISTANCE
    , EXTRA_POINT_RESULT
    , TWO_POINT_CONV_RESULT
    , HOME_TIMEOUTS_REMAINING
    , AWAY_TIMEOUTS_REMAINING
    , NFL_TIMEOUT
    , TIMEOUT_TEAM
    , TD_TEAM
    , TD_PLAYER_NAME
    , TD_PLAYER_ID
    , POSTEAM_TIMEOUTS_REMAINING
    , DEFTEAM_TIMEOUTS_REMAINING
    , TOTAL_HOME_SCORE
    , TOTAL_AWAY_SCORE
    , POSTEAM_SCORE
    , DEFTEAM_SCORE
    , SCORE_DIFFERENTIAL
    , POSTEAM_SCORE_POST
    , DEFTEAM_SCORE_POST
    , SCORE_DIFFERENTIAL_POST
    , NO_SCORE_PROB
    , OPP_FG_PROB
    , OPP_SAFETY_PROB
    , OPP_TD_PROB
    , FG_PROB
    , SAFETY_PROB
    , TD_PROB
    , EXTRA_POINT_PROB
    , TWO_POINT_CONVERSION_PROB
    , EP
    , EPA
    , TOTAL_HOME_EPA
    , TOTAL_AWAY_EPA
    , TOTAL_HOME_RUSH_EPA
    , TOTAL_AWAY_RUSH_EPA
    , TOTAL_HOME_PASS_EPA
    , TOTAL_AWAY_PASS_EPA
    , AIR_EPA
    , YAC_EPA
    , COMP_AIR_EPA
    , COMP_YAC_EPA
    , TOTAL_HOME_COMP_AIR_EPA
    , TOTAL_AWAY_COMP_AIR_EPA
    , TOTAL_HOME_COMP_YAC_EPA
    , TOTAL_AWAY_COMP_YAC_EPA
    , TOTAL_HOME_RAW_AIR_EPA
    , TOTAL_AWAY_RAW_AIR_EPA
    , TOTAL_HOME_RAW_YAC_EPA
    , TOTAL_AWAY_RAW_YAC_EPA
    , WP
    , DEF_WP
    , HOME_WP
    , AWAY_WP
    , WPA
    , VEGAS_WPA
    , VEGAS_HOME_WPA
    , HOME_WP_POST
    , AWAY_WP_POST
    , VEGAS_WP
    , VEGAS_HOME_WP
    , TOTAL_HOME_RUSH_WPA
    , TOTAL_AWAY_RUSH_WPA
    , TOTAL_HOME_PASS_WPA
    , TOTAL_AWAY_PASS_WPA
    , AIR_WPA
    , YAC_WPA
    , COMP_AIR_WPA
    , COMP_YAC_WPA
    , TOTAL_HOME_COMP_AIR_WPA
    , TOTAL_AWAY_COMP_AIR_WPA
    , TOTAL_HOME_COMP_YAC_WPA
    , TOTAL_AWAY_COMP_YAC_WPA
    , TOTAL_HOME_RAW_AIR_WPA
    , TOTAL_AWAY_RAW_AIR_WPA
    , TOTAL_HOME_RAW_YAC_WPA
    , TOTAL_AWAY_RAW_YAC_WPA
    , PUNT_BLOCKED
    , FIRST_DOWN_RUSH
    , FIRST_DOWN_PASS
    , FIRST_DOWN_PENALTY
    , THIRD_DOWN_CONVERTED
    , THIRD_DOWN_FAILED
    , FOURTH_DOWN_CONVERTED
    , FOURTH_DOWN_FAILED
    , INCOMPLETE_PASS
    , TOUCHBACK
    , INTERCEPTION
    , PUNT_INSIDE_TWENTY
    , PUNT_IN_ENDZONE
    , PUNT_OUT_OF_BOUNDS
    , PUNT_DOWNED
    , PUNT_FAIR_CATCH
    , KICKOFF_INSIDE_TWENTY
    , KICKOFF_IN_ENDZONE
    , KICKOFF_OUT_OF_BOUNDS
    , KICKOFF_DOWNED
    , KICKOFF_FAIR_CATCH
    , FUMBLE_FORCED
    , FUMBLE_NOT_FORCED
    , FUMBLE_OUT_OF_BOUNDS
    , SOLO_TACKLE
    , "SAFETY" AS SAFETY_FLAG
    , PENALTY
    , TACKLED_FOR_LOSS
    , FUMBLE_LOST
    , OWN_KICKOFF_RECOVERY
    , OWN_KICKOFF_RECOVERY_TD
    , QB_HIT
    , RUSH_ATTEMPT
    , PASS_ATTEMPT
    , SACK
    , TOUCHDOWN
    , PASS_TOUCHDOWN
    , RUSH_TOUCHDOWN
    , RETURN_TOUCHDOWN
    , EXTRA_POINT_ATTEMPT
    , TWO_POINT_ATTEMPT
    , FIELD_GOAL_ATTEMPT
    , KICKOFF_ATTEMPT
    , PUNT_ATTEMPT
    , FUMBLE
    , COMPLETE_PASS
    , ASSIST_TACKLE
    , LATERAL_RECEPTION
    , LATERAL_RUSH
    , LATERAL_RETURN
    , LATERAL_RECOVERY
    , PASSER_PLAYER_ID
    , PASSER_PLAYER_NAME
    , PASSING_YARDS
    , RECEIVER_PLAYER_ID
    , RECEIVER_PLAYER_NAME
    , RECEIVING_YARDS
    , RUSHER_PLAYER_ID
    , RUSHER_PLAYER_NAME
    , RUSHING_YARDS
    , LATERAL_RECEIVER_PLAYER_ID
    , LATERAL_RECEIVER_PLAYER_NAME
    , LATERAL_RECEIVING_YARDS
    , LATERAL_RUSHER_PLAYER_ID
    , LATERAL_RUSHER_PLAYER_NAME
    , LATERAL_RUSHING_YARDS
    , LATERAL_SACK_PLAYER_ID
    , LATERAL_SACK_PLAYER_NAME
    , INTERCEPTION_PLAYER_ID
    , INTERCEPTION_PLAYER_NAME
    , LATERAL_INTERCEPTION_PLAYER_ID
    , LATERAL_INTERCEPTION_PLAYER_NAME
    , PUNT_RETURNER_PLAYER_ID
    , PUNT_RETURNER_PLAYER_NAME
    , LATERAL_PUNT_RETURNER_PLAYER_ID
    , LATERAL_PUNT_RETURNER_PLAYER_NAME
    , KICKOFF_RETURNER_PLAYER_NAME
    , KICKOFF_RETURNER_PLAYER_ID
    , LATERAL_KICKOFF_RETURNER_PLAYER_ID
    , LATERAL_KICKOFF_RETURNER_PLAYER_NAME
    , PUNTER_PLAYER_ID
    , PUNTER_PLAYER_NAME
    , KICKER_PLAYER_NAME
    , KICKER_PLAYER_ID
    , OWN_KICKOFF_RECOVERY_PLAYER_ID
    , OWN_KICKOFF_RECOVERY_PLAYER_NAME
    , BLOCKED_PLAYER_ID
    , BLOCKED_PLAYER_NAME
    , TACKLE_FOR_LOSS_1_PLAYER_ID
    , TACKLE_FOR_LOSS_1_PLAYER_NAME
    , TACKLE_FOR_LOSS_2_PLAYER_ID
    , TACKLE_FOR_LOSS_2_PLAYER_NAME
    , QB_HIT_1_PLAYER_ID
    , QB_HIT_1_PLAYER_NAME
    , QB_HIT_2_PLAYER_ID
    , QB_HIT_2_PLAYER_NAME
    , FORCED_FUMBLE_PLAYER_1_TEAM
    , FORCED_FUMBLE_PLAYER_1_PLAYER_ID
    , FORCED_FUMBLE_PLAYER_1_PLAYER_NAME
    , FORCED_FUMBLE_PLAYER_2_TEAM
    , FORCED_FUMBLE_PLAYER_2_PLAYER_ID
    , FORCED_FUMBLE_PLAYER_2_PLAYER_NAME
    , SOLO_TACKLE_1_TEAM
    , SOLO_TACKLE_2_TEAM
    , SOLO_TACKLE_1_PLAYER_ID
    , SOLO_TACKLE_2_PLAYER_ID
    , SOLO_TACKLE_1_PLAYER_NAME
    , SOLO_TACKLE_2_PLAYER_NAME
    , ASSIST_TACKLE_1_PLAYER_ID
    , ASSIST_TACKLE_1_PLAYER_NAME
    , ASSIST_TACKLE_1_TEAM
    , ASSIST_TACKLE_2_PLAYER_ID
    , ASSIST_TACKLE_2_PLAYER_NAME
    , ASSIST_TACKLE_2_TEAM
    , ASSIST_TACKLE_3_PLAYER_ID
    , ASSIST_TACKLE_3_PLAYER_NAME
    , ASSIST_TACKLE_3_TEAM
    , ASSIST_TACKLE_4_PLAYER_ID
    , ASSIST_TACKLE_4_PLAYER_NAME
    , ASSIST_TACKLE_4_TEAM
    , TACKLE_WITH_ASSIST
    , TACKLE_WITH_ASSIST_1_PLAYER_ID
    , TACKLE_WITH_ASSIST_1_PLAYER_NAME
    , TACKLE_WITH_ASSIST_1_TEAM
    , TACKLE_WITH_ASSIST_2_PLAYER_ID
    , TACKLE_WITH_ASSIST_2_PLAYER_NAME
    , TACKLE_WITH_ASSIST_2_TEAM
    , PASS_DEFENSE_1_PLAYER_ID
    , PASS_DEFENSE_1_PLAYER_NAME
    , PASS_DEFENSE_2_PLAYER_ID
    , PASS_DEFENSE_2_PLAYER_NAME
    , FUMBLED_1_TEAM
    , FUMBLED_1_PLAYER_ID
    , FUMBLED_1_PLAYER_NAME
    , FUMBLED_2_PLAYER_ID
    , FUMBLED_2_PLAYER_NAME
    , FUMBLED_2_TEAM
    , FUMBLE_RECOVERY_1_TEAM
    , FUMBLE_RECOVERY_1_YARDS
    , FUMBLE_RECOVERY_1_PLAYER_ID
    , FUMBLE_RECOVERY_1_PLAYER_NAME
    , FUMBLE_RECOVERY_2_TEAM
    , FUMBLE_RECOVERY_2_YARDS
    , FUMBLE_RECOVERY_2_PLAYER_ID
    , FUMBLE_RECOVERY_2_PLAYER_NAME
    , SACK_PLAYER_ID
    , SACK_PLAYER_NAME
    , HALF_SACK_1_PLAYER_ID
    , HALF_SACK_1_PLAYER_NAME
    , HALF_SACK_2_PLAYER_ID
    , HALF_SACK_2_PLAYER_NAME
    , RETURN_TEAM
    , RETURN_YARDS
    , PENALTY_TEAM
    , PENALTY_PLAYER_ID
    , PENALTY_PLAYER_NAME
    , PENALTY_YARDS
    , REPLAY_OR_CHALLENGE
    , REPLAY_OR_CHALLENGE_RESULT
    , PENALTY_TYPE
    , DEFENSIVE_TWO_POINT_ATTEMPT
    , DEFENSIVE_TWO_POINT_CONV
    , DEFENSIVE_EXTRA_POINT_ATTEMPT
    , DEFENSIVE_EXTRA_POINT_CONV
    , SAFETY_PLAYER_NAME
    , SAFETY_PLAYER_ID
    , SEASON
    , COMPLETE_PASS_PROBABILITY
    , CPOE
    , SERIES
    , SERIES_SUCCESS
    , SERIES_RESULT
    , ORDER_SEQUENCE
    , START_TIME
    , TIME_OF_DAY
    , STADIUM
    , WEATHER
    , NFL_API_ID
    , PLAY_CLOCK
    , PLAY_DELETED
    , PLAY_TYPE_NFL
    , SPECIAL_TEAMS_PLAY
    , ST_PLAY_TYPE
    , END_CLOCK_TIME
    , END_YARD_LINE
    , FIXED_DRIVE
    , FIXED_DRIVE_RESULT
    , DRIVE_REAL_START_TIME
    , DRIVE_PLAY_COUNT
    , DRIVE_TIME_OF_POSSESSION
    , DRIVE_FIRST_DOWNS
    , DRIVE_INSIDE20
    , DRIVE_ENDED_WITH_SCORE
    , DRIVE_QUARTER_START
    , DRIVE_QUARTER_END
    , DRIVE_YARDS_PENALIZED
    , DRIVE_START_TRANSITION
    , DRIVE_END_TRANSITION
    , DRIVE_GAME_CLOCK_START
    , DRIVE_GAME_CLOCK_END
    , DRIVE_START_YARD_LINE
    , DRIVE_END_YARD_LINE
    , DRIVE_PLAY_ID_STARTED
    , DRIVE_PLAY_ID_ENDED
    , AWAY_SCORE
    , HOME_SCORE
    , GAME_LOCATION
    , GAME_RESULTS
    , TOTAL
    , SPREAD_LINE
    , TOTAL_LINE
    , DIV_GAME
    , ROOF
    , SURFACE
    , TEMPERATURE
    , WIND
    , HOME_COACH
    , AWAY_COACH
    , STADIUM_ID
    , GAME_STADIUM
    , ABORTED_PLAY
    , SUCCESS
    , PASSER
    , PASSER_JERSEY_NUMBER
    , RUSHER
    , RUSHER_JERSEY_NUMBER
    , RECEIVER
    , RECEIVER_JERSEY_NUMBER
    , PASS_FLAG
    , RUSH_FLAG
    , FIRST_DOWN_FLAG
    , SPECIAL_FLAG
    , PLAY_FLAG
    , PASSER_ID
    , RUSHER_ID
    , RECEIVER_ID
    , GENERIC_NAME
    , JERSEY_NUMBER
    , ID
    , FANTASY_PLAYER_NAME
    , FANTASY_PLAYER_ID
    , FANTASY
    , FANTASY_ID
    , OUT_OF_BOUNDS
    , HOME_OPENING_KICKOFF
    , QB_EPA
    , XYAC_EPA
    , XYAC_MEAN_YARDAGE
    , XYAC_MEDIAN_YARDAGE
    , XYAC_SUCCESS
    , XYAC_FD
    , XPASS
    , PASS_OE
FROM SOURCE